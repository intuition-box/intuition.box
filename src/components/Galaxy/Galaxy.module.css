:root[data-theme='light'] {
  --sun-core: rgba(200, 235, 255, 1);
  --sun-mid: rgba(94, 194, 231, 0.8);
  --sun-text: #0b2545;

  --dot-bg: rgba(255,255,255,0.12);
  --dot-border: rgba(255,255,255,0.25);
  --dot-shadow: 0 4px 20px rgba(0,0,0,0.3);
  --dot-text: #000;
  --dot-sheen: rgba(255,255,255,0.28);
  --dot-noise: rgba(0,0,0,0.03);
}

:root[data-theme='dark'] {
  --sun-core: rgba(200, 235, 255, 1);
  --sun-mid: rgba(94, 194, 231, 0.8);
  --sun-text: #0b2545;

  --dot-bg: rgba(255,255,255,0.12);
  --dot-border: rgba(255,255,255,0.25);
  --dot-shadow: 0 4px 20px rgba(0,0,0,0.3);
  --dot-text: #fff;
  --dot-sheen: rgba(255,255,255,0.28);
  --dot-noise: rgba(255,255,255,0.03);
}

.galaxyWrapper {
  position: relative;
  width: 100%;
  height: 80vh;
  max-height: 850px;
  min-height: 600px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding-bottom: 8rem;
  margin-bottom: 10rem;
  margin-block-start: clamp(40px, 6vw, 120px);
}

.galaxyBg {
  position: absolute;
  inset: 0;
  z-index: 0;
  pointer-events: none;
  background-repeat: no-repeat;
  background-position: center;
  background-size: 60%;
  background-image: url("../Backgrounds/light_galaxy.svg");
  animation: spinGalaxy 200s linear infinite;
  transform-origin: center;
}
@media (max-width: 640px) {
  .galaxyBg { background-size: 250%; }
}
@keyframes spinGalaxy {
  from { transform: rotate(0deg); }
  to   { transform: rotate(360deg); }
}

.centralCircle {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 280px;
  height: 280px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 15;
  pointer-events: none;
}
.centralCircle::before,
.centralCircle::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: 50%;
  pointer-events: none;
}
.centralCircle::before {
  background: radial-gradient(circle, var(--sun-core) 0%, var(--sun-mid) 35%, transparent 70%);
  filter: blur(12px);
}
.centralCircle::after {
  background: radial-gradient(circle, var(--sun-core) 0%, transparent 70%);
  filter: blur(25px);
  animation: starPulse 4s ease-in-out infinite;
  opacity: 0.5;
}
@keyframes starPulse {
  0%, 100% { transform: scale(1); opacity: 0.7; }
  50%      { transform: scale(1.15); opacity: 1; }
}
.centralCircle h2 {
  position: relative;
  z-index: 1;
  margin: 0;
  font-family: 'Montserrat', sans-serif;
  font-weight: 700;
  letter-spacing: 0.04em;
  text-shadow: 0 0 20px var(--sun-core), 0 0 40px var(--sun-mid);
  color: var(--sun-text);
  pointer-events: none;
}

@media (prefers-reduced-motion: reduce) {
  .galaxyBg { animation: none !important; }
  .centralCircle::after { animation: none !important; }
}


/* =========================================================
   LAYOUT LAYERS
   =======================================================*/
.boxesContainer {
  position: absolute;
  inset: 0;
  pointer-events: none;
}

.orbit,
.orbitProjects {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 2;
}
.orbitProjects { z-index: 3; }  /* au-dessus des commits */

@keyframes orbitSpin {
  from { transform: rotate(0deg) translateX(var(--orbit-radius)) rotate(0deg); }
  to   { transform: rotate(360deg) translateX(var(--orbit-radius)) rotate(-360deg); }
}

.commit,
.project {
  --orbit-radius: 180px;
  position: absolute;
  top: 50%;
  left: 50%;
  transform-origin: 0 0;
  animation: orbitSpin linear infinite;
  pointer-events: auto;
  display: flex;
  align-items: center;
  justify-content: center;
  user-select: none;
  will-change: transform;
  font-size: 0.6rem;
}

/* commit (circle) */
.commit {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: radial-gradient(circle at 30% 30%, rgb(255 255 255 / 22%), rgb(131 145 255 / 95%));
  box-shadow: 0 2px 6px rgba(0,0,0,0.4);
  color: rgb(0, 0, 0);
  cursor: pointer;
}
.commit[data-clickable="true"] { cursor: pointer; }
.commit:focus-visible { outline: 2px solid #7aa2ff; outline-offset: 2px; border-radius: 50%; }

/* project (square) */
.project {
  width: 32px;
  height: 32px;
  border-radius: 6px;
  background: linear-gradient(135deg, rgb(255 255 255 / 0%), rgb(255 255 255 / 44%));
  box-shadow: 0 2px 6px rgba(0,0,0,0.4);
}

@media (prefers-reduced-motion: reduce) {
  .commit, .project { animation: none !important; }
}


.contribCard {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 260px;
  padding: .5rem .65rem;
  box-sizing: border-box;
  background: var(--dot-bg);
  border: 1px solid var(--dot-border);
  border-radius: 14px;
  backdrop-filter: blur(14px) saturate(1.15);
  -webkit-backdrop-filter: blur(14px) saturate(1.15);
  box-shadow: var(--dot-shadow);
  color: var(--dot-text);
  overflow: hidden;
  transition: transform .25s ease, box-shadow .25s ease, border-color .25s ease;
  pointer-events: auto;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 5;
}
.contribCard::before,
.contribCard::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  pointer-events: none;
}
.contribCard::before {
  background: radial-gradient(110px 60px at 6% 8%, var(--dot-sheen), transparent 60%);
  mix-blend-mode: screen;
}
.contribCard::after {
  background:
    linear-gradient(transparent 0, rgba(255,255,255,0.02) 100%),
    repeating-linear-gradient(0deg, transparent 0 1px, var(--dot-noise) 1px 2px);
  opacity: 0.6;
}
.contribCard:hover {
  transform: translateY(-6px);
  box-shadow: 0 22px 52px rgba(0,0,0,0.28);
  border-color: rgba(255,255,255,0.9);
}

.cardHeaderClickable {
  display:flex;
  align-items:center;
  justify-content:center;
  gap:.5rem;
  cursor:pointer;
}
.cardHeaderClickable:hover { opacity:.85; }

.cardAvatar {
  border-radius: 50%;
  box-shadow: 0 0 0 1px rgba(255,255,255,.12);
}
.contribCardTitle {
  font-size: 1.05rem;
  margin: 0;
  font-family: 'Montserrat', Arial, sans-serif;
  text-align: center;
}

.contribCardSummary {
  margin: 0;
  margin-top: .15rem;
  line-height: 1.25;
  text-align: center;
  opacity: .95;
  font-size: .82rem;
  position: relative;
  z-index: 1;
}
.summaryCompact {
  display: -webkit-box;
  -webkit-line-clamp: 1;
  -webkit-box-orient: vertical;
  overflow: hidden;
  font-size: .78rem;
}
.cardDivider {
  height: 1px;
  background: rgba(255,255,255,0.15);
  margin: .5rem 0;
}

.contribExpander {
  overflow: hidden;
  opacity: 0;
  max-height: 0;
  transition: max-height .28s ease, opacity .18s ease;
  will-change: max-height, opacity;
  position: relative;
  z-index: 1;
}
.contribExpander::before,
.contribExpander::after { pointer-events: none; }  /* üëà s√©curit√© overlay */
.contribExpanderOpen { opacity: 1; }
.contribExpanderInner { padding-top: .25rem; }

.metricsTitle {
  font-size: .86rem;
  font-weight: 600;
  opacity: .9;
  margin: .1rem 0 .25rem;
  text-align: left;
}

.projectsGrid {
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  grid-template-columns: 1fr;
  position: relative; z-index: 1;
}
.projectItem {
  display: flex;
  align-items: center;
  gap: .5rem;
  cursor: pointer;
}
.projSquare {
  width: 18px;
  height: 18px;
  border-radius: 5px;
  background: linear-gradient(135deg, rgba(255,255,255,0.6), rgba(255,255,255,0.05));
  box-shadow: 0 2px 6px rgba(0,0,0,0.35);
  flex: 0 0 auto;
  transition: transform .15s ease, box-shadow .15s ease;
}
.projectItem:hover .projSquare {
  transform: translateY(-1px);
  box-shadow: 0 4px 10px rgba(0,0,0,.4);
}
.projectName {
  font-size: .86rem;
  line-height: 1.25;
  opacity: .95;
  text-align: left;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}

.projectLink {
  display: inline-flex;
  align-items: center;
  text-decoration: none;
  outline: none;
}
.projectLink:focus-visible,
.projectName:focus-visible {
  outline: 2px solid #7aa2ff;
  outline-offset: 2px;
  border-radius: 6px;
}

.muted { opacity: .75; }


.projectCard {
  position: fixed;
  z-index: 100;
  width: 320px;
  border-radius: 18px;
  overflow: hidden;
  box-shadow: 0 12px 32px rgba(0,0,0,0.55);
  color: #fff;
  font-family: 'Nunito', sans-serif;
}

.projectCardHeader {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: .75rem 1rem 0 1.25rem;
}
.projectDate { color: #ddd; font-size: 0.9rem; }

.projectExternal {
  color: #fff;
  width: 24px; height: 24px;
  display: flex; align-items: center; justify-content: center;
}
.projectExternal svg { width: 20px; height: 20px; }

.projectCardBody {
  padding: .4rem 1rem .2rem 1.25rem;
  text-align: left; color: #fff;
}
.projectTitle {
  margin: .2rem 0 .3rem;
  font-size: 1.18rem;
  font-weight: 700;
  text-transform: none;
}

.projectCardFooter {
  border-top: 1px solid #292929;
  display: flex;
  align-items: center;
  justify-content: flex-start;
  padding: 1rem 1rem;
  background: #151419;
}
.participantsStack { display: flex; align-items: center; margin: 0; padding: 0; }
.participantsStack li { list-style: none; display: flex; margin-right: -10px; }
.participantAvatar {
  width: 28px; height: 28px;
  border-radius: 50%;
  border: 1px solid #333;
  object-fit: cover;
  box-shadow: 0 2px 6px rgba(0,0,0,0.3);
}

@media (prefers-reduced-motion: reduce) {
  .contribCard, .commit, .project { transition: none !important; }
}

/* ===== MOBILE TWEAK ‚Äì garder tout dans l'√©cran et √©loigner les projects ===== */

/* palier 1 : ‚â§ 640px */
@media (max-width: 640px) {
  /* √âtroit en largeur, un peu plus haut : scale anisotrope */
  .boxesContainer,
  .orbit,
  .orbitProjects {
    transform: scale(0.56, 0.66);  /* ‚Üê moins large que haut */
    transform-origin: 50% 50%;
  }

  /* Rayon diff√©rent commit vs project (projects + loin du soleil) */
  .commit  { --orbit-radius: 92px  !important; }
  .project { --orbit-radius: 122px !important; }  /* +30px vs commit */

  /* Contributeurs un poil plus √©troits = pas de d√©passement lat√©ral */
  .contribCard { width: 172px; }

  /* Soleil un chou√Øa plus petit pour augmenter l‚Äôespace per√ßu */
  .centralCircle { width: 160px; height: 160px; }
}

/* palier 2 : ‚â§ 420px */
@media (max-width: 420px) {
  .boxesContainer,
  .orbit,
  .orbitProjects { transform: scale(0.50, 0.62); }

  .commit  { --orbit-radius: 80px  !important; }
  .project { --orbit-radius: 110px !important; }

  .contribCard { width: 158px; }
  .centralCircle { width: 148px; height: 148px; }
}

/* palier 3 : ‚â§ 360px ou paysage bas */
@media (max-width: 360px), (max-height: 540px) and (orientation: landscape) {
  .boxesContainer,
  .orbit,
  .orbitProjects { transform: scale(0.46, 0.60); }

  .commit  { --orbit-radius: 72px  !important; }
  .project { --orbit-radius: 102px !important; }

  .contribCard { width: 150px; }
  .centralCircle { width: 136px; height: 136px; }
}

/* s√©curit√© : on garde le contenu "dans" le wrapper */
@media (max-width: 640px) {
  .galaxyWrapper { overflow: hidden; }
}
